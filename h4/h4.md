# h4 - Maailma kuulee

Teht√§v√§ss√§:
- Tiivist√§n kaksi artikkelia
- Vuokraan oman virtuaalipalvelimen palveluntarjoajalta
- Teen tarvittavat toimet virtuaalipalvelimen alustamiseen
- Asennan Apachen ja korvaan palvelimen oletussivuston


## Tiivistelm√§t 

*11.9.2025*
### Susanna Lehto: Teoriasta k√§yt√§nt√∂√∂n pilvipalvelimen avulla[^1]

Tiivistelm√§ss√§ k√§sitell√§√§n Susanna Lehdon blogikirjoituksen seuraavia kohtia:

#### a)  Pilvipalvelimen vuokraus ja asennus

- Lehto k√§y vaihe vaiheelta askeleet virtuaalipalvelimen vuokrausta ja asennusta varten
- Palveluntarjoajana Lehto k√§ytti DigitalOceania
- Lehto n√§ytt√§√§ my√∂s miten osoitteen nimen voi vuokrata
- Nimen vuokraamiseen Lehto k√§ytti NameCheap-palvelua ja hy√∂dynsi Github-tili√§√§n alennuksen saamiseen

#### d) Palvelin suojaan palomuurilla

T√§ss√§ kohdassa Lehto: 

- Avasi SSH-yhteyden virtuaalipalvelimeen
- Haki uudet p√§ivitykset apt-get update -komennolla
- Asensi palomuurin (ufw) ja avasi siihen rei√§n yhdelle portille
- Laittoi palomuurin p√§√§lle

#### e) Kotisivut palvelimelle

T√§ss√§ kohtaa:

- Lehto lis√§si vuokratulle palvelimelle uuden k√§ytt√§j√§n ja teki siit√§ p√§√§k√§ytt√§j√§n
- SSH-yhteys avattiin ja root lukittiin
- Uudet p√§ivitykset haettiin ja asennettiin
- Asennettiin Apache palvelimelle ja tehtiin palomuuriin uusi reik√§ portille
- Korvattiin Apache-oletussivu yksinkertaisella html-dokumentilla
- Sivusto n√§kyy vuokratussa osoitteessa

#### f) Palvelimen ohjelmien p√§ivitys

Lehto haki ja asensi uudet p√§ivitykset, tietoturvap√§ivitykset mukaan lukien.

### Tero Karvinen: First Steps on a New Virtual Private Server ‚Äì an Example on DigitalOcean and Ubuntu 16.04 LTS [^2]

Tero Karvisen artikkeli sis√§lt√§√§ ohjeet: 

- GitHub Education-paketin lunastamiseen
- SSH-avainten k√§ytt√§miseen
- Sudo-k√§ytt√§j√§n luontiin vuokratulla palvelimella
- Root-k√§ytt√§j√§n sulkemiseen 
- Uusien p√§ivitysten hakemiseen ja asennukseen
- Palomuurin k√§ytt√∂√∂n vuokratulla palvelimella
- Osoitteen vuokraamiseen palveluntarjoajalta (NameCheap)


*Tiivistelmiin k√§ytetty aika*: **17.25-18.25**

## Harjoitus - Julkisen palvelimen vuokraaminen

*12.9.2025*

**20:30** aloitin harjoituksen tekemisen. 

### Palveluntarjoajan valinta

Valitsin palveluntarjoajaksi UpCloudin tunnilla n√§ytetyn esimerkin johdosta. 

Olin juuri ennen teht√§v√§n aloitusta luonut ja vahvistanut tilin UpCloudille, sek√§ ottanut vahvistuksen mukana viikon ilmaiskokeilun: 

KUVA(upcloud)

**20:40** aloitin virtuaalipalvelimen pystytt√§misen painikkeesta **Deploy Now** -> **Server**.
Palvelimen alustamisessa valitsin seuraavat vaihtoehdot: 

- **Sijainti**: FI-HEL1 üá´üáÆ
- **Tyyppi**: Developer (1 GPU, 1GB RAM, 10GB storage, 3‚Ç¨/kuukausi)
- Automaattiset varmuuskopiot pois k√§yt√∂st√§
- **OS:** Debian GNU: Linux 13 (Trixie)
- **Verkko**: Julkinen IPv4, Utility Network, julkinen IPv6
- **Kirjautuminen**: SSH-avaimet

T√§ss√§ kohtaa selvitin my√∂s itselleni j√§√§neit√§ kysymyksi√§ SSH:n toiminnasta[^3]. Loin SSH-avaimen linuxin komentorivill√§, komennolla: 

    ssh-keygen

Itse avaimen luonti onnistui hyvin, mutta julkisen avaimen kopiointi ja lis√§√§minen virtuaalipalvelimen alustukseen Windowsin puolelle tuotti ongelmia. Edes virtuaalikoneen asetusten muokkaaminen (Shared Clipboard ja Drag & Drop -> Bidirectional) ei auttanut ongelmaan, joten p√§√§tin tehd√§ k√§ytt√∂√∂noton linuxilla, jolloin SSH-avaimen lis√§√§minen onnistui. 

K√§ytin seuraavissa vaiheissa vahvasti yll√§tiivist√§mi√§ni artikkeleja Susanna Lehdolta[^1] ja Tero Karviselta[^2]. 

**21:30** l√§hdin kirjautumaan vuokraamalleni palvelimelle. Kirjauduin palvelimen juureen komennolla

    ssh root@(ip-osoite)
    
Kirjautumisen onnistuttua latasin virtuaalipalvelimelle ufw-palomuurin ja loin siihen rei√§n: 

    sudo apt-get install ufw
    sudo ufw allow 22/tcp

T√§m√§n j√§lkeen laitoin palomuurin p√§√§lle: 

    sudo ufw enable

**21:46** rupesin luomaan uutta k√§ytt√§j√§√§ virtuaalipalvelimelle. K√§ytin Tero Karvisen artikkelissa[^2] n√§ytettyj√§ komentoja k√§ytt√§j√§n luomiseen ja k√§ytt√§j√§ryhmiin lis√§√§mist√§ varten: 

        sudo adduser jani
        sudo adduser jani sudo
        sudo adduser jani adm

Komennot meniv√§t l√§pi. 

**21:56** avasin uuden terminaalin aiemman viereen ja kirjauduin sen j√§lleen uuteen palvelimeen juuri luomallani k√§ytt√§j√§ll√§: 

    ssh jani@94.237.114.152

T√§m√§ ei kuitenkaan onnistunut. Selvittelin ChatGPT:n avulla[^4] ongelmana olleen, ettei uudella k√§ytt√§j√§ll√§ voinut viel√§ kirjautua SSH-avaimen avulla, vaan salasanalla. T√§m√§ oli kuitenkin kielletty uuden palvelimen ssh-asetuksissa, joten k√§vin muokkaamassa tiedostoa: 

    PasswordAuthentication Yes 

**22:15** uudelleenk√§ynnistin SSH:n komennolla

    systemctl restart ssh

Yritin taas kirjautua uudella k√§ytt√§j√§ll√§, mutta ongelma pysyi samana.

**22:23** kokeilin toista ChatGPT:n vaihtehtoa[^4], jossa kopioin root-k√§ytt√§j√§n SSH-avaimen uudelle k√§ytt√§j√§lle. 

Loin ensin uuden .ssh-hakemiston uudelle k√§ytt√§j√§lle: 

    mkdir -p /home/jani/.ssh

T√§m√§n j√§lkeen kopion juurik√§ytt√§j√§n .ssh-hakemistosta julkisen avaimen uuden k√§ytt√§j√§n vastaavaan hakemistoon: 

    cp /root/.ssh/authorized_keys /home/jani/.ssh/

Tsekkasin t√§ss√§ v√§liss√§ hakemiston: 

KUVA (root_ls)

Huomasin, ett√§ tiedoston ja kansion oikeuksia pit√§isi muuttaa. Muutin ensin hakemiston omistajuuden uudelle k√§ytt√§j√§lleni chown-komennolla: 

KUVA(chown)

T√§m√§n j√§lkeen my√∂s muokkasin hakemiston ja sinne kopioidun tiedoston k√§ytt√∂oikeuksia chmod -komennolla: 

KUVA(chmod) 

**22:47** SSH-kirjautuminen uutena k√§ytt√§j√§n√§ onnistui:

KUVA(ssh_login)

**22:55** lukitsin root-k√§ytt√§j√§n, ensiksi salasanakirjautumisen komennolla: 

     sudo usermod --lock root 

Sitten menin ssh:n konfigurointihakemistoon (/etc/ssh/) ja muokkasin sshd_config -tiedostosta PermitRootLogin-kohdan kielteiseksi.

KUVA(h4_prl)

T√§m√§n tehty√§ni k√§ynnistin SSH:n uudelleen, jonka j√§lkeen p√§ivitin paketit. 

    sudo service ssh restart
    sudo apt-get update
    sudo apt-get upgrade

**23:10** kirjauduin ulos root-k√§ytt√§j√§lt√§. 

```bash
root@debian-lcpu-lgb-fi-hel1:~# exit
logout
Connection to 94.237.114.152 closed.
jani@linux-kurssi: ~$
```

**23:15** aloin asentamaan Apache uudelle virtuaalipalvelimelle. Ensin tein rei√§n palomuuriin porttia varten: 

    sudo ufw allow 80/tcp

Latasin Apachen komennolla ja varmistin sen toiminnan seuraavilla komennoilla: 

    sudo apt-get install apache2
    sudo systemctl status apache2

**23:20** testasin localhostin sis√§lt√∂√§ curl-komennolla, ja se palautti apachen oletussivun. K√§vin viel√§ Firefoxissa katsomassa, ett√§ palauttaako ip-osoite saman sivuston: 

KUVA (h4_apache.png)

Teht√§v√§nannon mukaisesti l√§hdin korvaamaan Apachen oletussivua simppelill√§ tekstill√§. 

KUVA (h4_index_edit.png)

T√§m√§n j√§lkeen ip-osoitteen sivusto n√§ytti hieman erilaiselta.

KUVA (h4_index_ff.png)

**23:35** testasin viel√§ k√§nnyk√§ll√§ samaa osoitetta, ja se toimi niinkuin pitikin.

*Harjoitukseen k√§ytetty aika*: **20:30-23:35**


### L√§hteet

K√§ytin t√§ss√§ harjoituksessa ja tiivistelmiss√§ seuraavia l√§hteit√§: 

[^1]: Lehto, Susanna: 2022-02-14. Teoriasta k√§yt√§nt√∂√∂n pilvipalvelimen avulla (h4). https://susannalehto.fi/2022/teoriasta-kaytantoon-pilvipalvelimen-avulla-h4/

[^2]: Karvinen, Tero: 2017-09-17. First Steps on a New Virtual Private Server ‚Äì an Example on DigitalOcean and Ubuntu 16.04 LTS. First Steps on a New Virtual Private Server ‚Äì an Example on DigitalOcean and Ubuntu 16.04 LTS

[^3]: SSH. How to Use ssh-keygen to Generate a New SSH Key? https://www.ssh.com/academy/ssh/keygen

[^4]:ChatGPT, ongelmanratkontaan uuden k√§ytt√§j√§n kanssa kirjautumisessa. 
